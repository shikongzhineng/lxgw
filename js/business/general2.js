$(function () {
  var zhengji = {
    title: '整机产品',
    name: 'zhengji',
    list: [
      {
        title: '桌面产品',
        list: [
          {
            title: '同方超翔系列龙芯台式机电脑',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/786.html',
            img: '2-1Z4261I54M29-lp.jpg'
          },
          {
            title: '同方超翔系列龙芯一体机机电脑',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/785.html',
            img: '2-1Z4261HKH48-lp.jpg'
          },
          {
            title: '微型计算机-天钥TR1171',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/766.html',
            img: '2-1Z416101412402-lp.png'
          },
          {
            title: '方正D300龙芯台式机',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/800.html',
            img: '2-1Z50Q52400545-lp.jpg'
          },
          {
            title: '中科曙光L300-G25桌面终端',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/720.html',
            img: '1-1Z319161645131-lp.png'
          },
          {
            title: '申泰DT3000-L通用台式机计算机',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/798.html',
            img: '2-1Z524144024406.jpg'
          },
          {
            title: '百信辰龙201F-A可靠计算机',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/763.html',
            img: '2-1Z4160Z60B55-lp.jpg'
          },
          {
            title: '龙芯开发者电脑',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/828.html',
            img: '2-1Z522092152922-lp.jpg'
          },
          {
            title: '百信辰龙201F-A可靠计算机',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/763.html',
            img: '2-1Z4160Z60B55-lp.jpg'
          },
          {
            title: '中科曙光L300-G25桌面终端',
            link: '/business/general2/zhengji/zhuomiandiannao/201906/720.html',
            img: '1-1Z319161645131-lp.png'
          },
        ]
      },
      {
        title: '笔记本产品',
        list: [
          {
            title: '便携式计算机-天钥TR4172',
            link: '/business/general2/zhengji/bijiben/201904/769.html',
            img: '62.jpg'
          },
          {
            title: '同方超锐系列龙芯笔记本电脑',
            link: '/business/general2/zhengji/bijiben/201904/784.html',
            img: '2-1Z4261G434253-lp.jpg'
          },
          {
            title: '方正N300龙芯笔记本',
            link: '',
            img: '2-1Z50Q52946364-lp.jpg'
          }
        ]
      },
      {
        title: '服务器',
        list: [
          {
            title: '机架式服务器-天钥SR117220',
            link: '/business/general2/zhengji/fuwuqi/201904/770.html',
            img: '61.jpg'
          },
          {
            title: '机架式服务器-天钥SR117440',
            link: '/business/general2/zhengji/fuwuqi/201904/767.html',
            img: '65.jpg'
          },
          {
            title: '同方超强系列龙芯服务器',
            link: '/business/general2/zhengji/fuwuqi/201905/787.html',
            img: '2-1Z50612015T56-lp.jpg'
          },
          {
            title: '中科曙光L620-G25服务器',
            link: '/business/general2/zhengji/fuwuqi/201903/721.html',
            img: '1-1Z319160530530-lp.png'
          },
          {
            title: '申泰RM5020（龙芯）通用服务器',
            link: '/business/general2/zhengji/fuwuqi/201905/799.html',
            img: '2-1Z50Q51644I5-lp.jpg'
          },
          {
            title: '百信云龙301E-A安全可靠服务器',
            link: '/business/general2/zhengji/fuwuqi/201904/764.html',
            img: '2-1Z4160Z60B55-lp.jpg'
          },
          {
            title: '方正SR2000龙芯服务器',
            link: '/business/general2/zhengji/fuwuqi/201905/802.html',
            img: '2-1Z50Q5333X21-lp.jpg'
          },
          {
            title: '中科曙光4路龙芯服务器',
            link: '/business/general2/zhengji/fuwuqi/201906/845.html',
            img: '2-1Z61014560Vb.jpeg'
          },
        ]
      },
      {
        title: '存储',
        list: [
          {
            title: '滕凌科技存储',
            link: '/business/general2/zhengji/cunchu/201906/729.html',
            img: '2-1Z329102442616.jpg'
          },
          {
            title: '升腾C76云终端',
            link: '/business/general2/zhengji/yunzhongduan/201903/725.html',
            img: '2-1Z32G41JD57-lp.jpg'
          }
        ]
      },
      {
        title: '行业一体机',
        list: [
          {
            title: '东软医疗自助一体机',
            link: '/business/general2/zhengji/xingyeyitiji/201906/850.html',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: 'ZDNS域名服务一体机',
            link: '/business/general2/zhengji/xingyeyitiji/201906/851.html',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '银信运维一体机',
            link: '/business/general2/zhengji/xingyeyitiji/201906/853.html',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '红像云滕大数据一体机',
            link: '/business/general2/zhengji/xingyeyitiji/201906/852.html',
            img: '2-1Z61014560Vb.jpeg'
          },
        ]
      }
    ]
  }
  var xitong = {
    title: '操作系统',
    name: 'xitong',
    list: [
      {
        title: '桌面操作系统',
        list: [
          {
            title: '龙芯社区版操作系统',
            link: '/business/general2/xitong/zhuomiancaozuoxitong/201906/891.html',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '中标麒麟桌面操作系统',
            link: '/business/general2/xitong/zhuomiancaozuoxitong/201904/744.html',
            img: '57.jpg'
          },
          {
            title: '深度桌面操作系统龙芯版',
            link: '/business/general2/xitong/zhuomiancaozuoxitong/201903/719.html',
            img: '1-1Z31Q93559602-lp.jpg'
          },
          {
            title: '麒麟操作系统（湖南麒麟）',
            link: 'business/general2/xitong/zhuomiancaozuoxitong/201904/771.html',
            img: '56.jpg'
          },
          {
            title: '新支点桌面操作系统龙芯版',
            link: '/business/general2/xitong/zhuomiancaozuoxitong/201905/831.html',
            img: '2-1Z523135G5221-lp.jpg'
          },
          {
            title: '凝思安全操作系统V6.0（桌面版）',
            link: '/business/general2/xitong/zhuomiancaozuoxitong/201906/1103.html',
            img: '2-1Z61409420Mc.jpg'
          },
        ]
      },
      {
        title: '服务器操作系统',
        list: [
          {
            title: '中标麒麟高级服务器操作系统',
            link: '',
            img: '57.jpg'
          },
          {
            title: '深度服务器操作系统龙芯版',
            link: '/business/general2/xitong/fuwuqicaozuoxitong/201903/714.html',
            img: '1-1Z31QJH0641-lp.png'
          },
          {
            title: '新支点电信级服务器操作系统龙芯版V4.0',
            link: '/business/general2/xitong/fuwuqicaozuoxitong/201905/832.html',
            img: '2-1Z523141P45Z-lp.jpg'
          },
          {
            title: '凝思安全操作系统V6.0（服务器版）',
            link: '/business/general2/xitong/fuwuqicaozuoxitong/201906/1104.html',
            img: '2-1Z61409420Mc.jpg'
          },
        ]
      },
      {
        title: '云操作系统',
        list: [
          {
            title: '普华云操作系统',
            link: '/business/general2/xitong/yuncaozuoxitong/201903/732.html',
            img: '2-1Z3291624401G.png'
          }
        ]
      },
      {
        title: '嵌入式操作系统',
        list: [
          {
            title: '新支点电信级嵌入式操作系统龙芯版',
            link: '/business/general2/xitong/qianrushicaozuoxitong/201905/833.html',
            img: '2-1Z523142HJ26-lp.jpg'
          },
          {
            title: 'VxWorks板级支持包软件',
            link: '/business/general2/xitong/qianrushicaozuoxitong/201906/1113.html',
            img: 'defaultpic.gif'
          }
        ]
      }
    ]
  }
  var waishe = {
    title: '外设适配',
    name: 'waishe',
    list: [
      {
        title: '打印机',
        list: [
          {
            title: '奔图P3305DN A4黑白激光单功能打印机',
            link: '/business/general2/waishe/dayinji/201904/743.html',
            img: '2-1Z409151RW02-lp.png'
          },
          {
            title: '奔图P2505 A4黑白激光单功能打印机',
            link: '/business/general2/waishe/dayinji/201904/750.html',
            img: '2-1Z409151RW02-lp.png'
          },
          {
            title: '奔图P5000DN A4黑白激光单功能打印机',
            link: '/business/general2/waishe/dayinji/201904/751.html',
            img: '2-1Z409151RW02-lp.png'
          },
          {
            title: '奔图P2505DN A4红黑双色打印机',
            link: '/business/general2/waishe/dayinji/201904/754.html',
            img: '2-1Z409151RW02-lp.png'
          },
          {
            title: '奔图P2500DN A4彩色单功能打印机',
            link: '/business/general2/waishe/dayinji/201904/755.html',
            img: '2-1Z409151RW02-lp.png'
          },
          {
            title: '奔图P3255DN',
            link: '/business/general2/waishe/dayinji/201906/892.html',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '奔图M6255N',
            link: '/business/general2/waishe/dayinji/201906/893.html',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '奔图P3500DN',
            link: '/business/general2/waishe/dayinji/201906/894.html',
            img: '2-1Z61014560Vb.jpeg'
          },
        ]
      },
      {
        title: '扫描仪',
        list: [
          {
            title: '奔图DS-230 ADF高速扫描仪',
            link: '',
            img: '2-1Z409151RW02-lp.png'
          },
          {
            title: '紫光扫描仪 Uniscan F35D',
            link: '/business/general2/waishe/saomiaoyi/201905/819.html',
            img: '2-1Z52111064a93-lp.jpg'
          },
          {
            title: '紫光扫描仪 Uniscan Q2230',
            link: '/business/general2/waishe/saomiaoyi/201905/818.html',
            img: '2-1Z52111012D04-lp.jpg'
          },
          {
            title: '紫光扫描仪 Uniscan Q400',
            link: '/business/general2/waishe/saomiaoyi/201905/817.html',
            img: '2-1Z521104Z1415-lp.jpg'
          },
          {
            title: '影源x2210',
            link: '',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '影源x2620+',
            link: '',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '虹光FB2080E',
            link: '',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '紫光Uniscan FS6600 Plus',
            link: '',
            img: '2-1Z61014560Vb.jpeg'
          },
          {
            title: '紫光Uniscan Q2240',
            link: '',
            img: '2-1Z61014560Vb.jpeg'
          },
        ]
      }
    ]
  }
  var fangan = {
    title: '业务方案',
    name: 'fangan',
    list: [
      {
        title:'中间件',
        list:[
          {
            title:'东方通应用服务器软件',
            link:'javascript:;',
            img:'2-1Z32Z9342A93-lp.jpg'
          },
          {
            title:'中创中间件',
            link:'javascript:;',
            img:'1-1Z31QQ924147-lp.png'
          },
          {
            title:'金蝶天燕应用服务器',
            link:'javascript:;',
            img:'2-1Z416161G4624-lp.png'
          },
          {
            title:'金蝶天燕消息中间件',
            link:'javascript:;',
            img:'2-1Z4161F535K9-lp.jpg'
          },
        ]
      },
      {
        title:'数据库',
        list:[
          {
            title:'达梦数据库管理系统龙芯版',
            link:'javacript:;',
            img:'2-1Z329155A2Y6.jpg'
          },
          {
            title:'神通数据库',
            link:'javacript:;',
            img:'2-1Z41516224L05-lp.jpg'
          },
          {
            title:'金仓数据库管理系统',
            link:'javacript:;',
            img:'58.jpg'
          },
          {
            title:'南大数据库',
            link:'javacript:;',
            img:'2-1Z61014560Vb.jpeg'
          },
          {
            title:'汉高数据库',
            link:'javacript:;',
            img:'2-1Z61014560Vb.jpeg'
          },
          {
            title:'优炫数据库',
            link:'javacript:;',
            img:'2-1Z61014560Vb.jpeg'
          },
          {
            title:'开源Mysql/Mariadb',
            link:'javacript:;',
            img:'2-1Z61014560Vb.jpeg'
          },
        ]
      },
      {
        title:'云平台',
        list:[
          {
            title:'希云cSphere容器解决方案',
            link:'javascript:;',
            img:'2-1Z4261F602R9-lp.jpg'
          },
          {
            title:'天熠云',
            link:'javascript:;',
            img:'2-1Z40110160R95-lp.jpg'
          },
          {
            title:'DaoCloud Enterprise云平台',
            link:'javascript:;',
            img:'1-1ZF2155224203.png'
          },
          {
            title:'龙芯KVM',
            link:'javascript:;',
            img:'2-1Z61014560Vb.jpeg'
          },
        ]
      },
      {
        title:'虚拟云桌面',
        list:[
          {
            title:'同方虚拟云桌面系统',
            link:'javascript:;',
            img:'1-1ZF3092959233.png'
          },
          {
            title:'升腾威讯云系统（龙芯云桌面解决方案）',
            link:'javascript:;',
            img:'1-1ZF3095155446.png'
          },
          {
            title:'湖南麒麟安全云桌面系统（龙芯版）',
            link:'javascript:;',
            img:'1-1ZF3101315963.png'
          },
        ]
      },
      {
        title:'大数据',
        list:[
          {
            title:'红象云滕大数据基础软件产品',
            link:'javascript:;',
            img:'2-1Z5211AK2408-lp.jpg'
          },
          {
            title:'金蝶天燕大数据集成',
            link:'javascript:;',
            img:'2-1Z4161H34L19-lp.png'
          },
        ]
      },
      {
        title:'高可用集群',
        list:[
          {
            title:'中标麒麟高可用集群软件',
            link:'javascript:;',
            img:'57.jpg'
          },
        ]
      },
      {
        title:'邮件',
        list:[
          {
            title:'Coremail安全增强电子邮件系统',
            link:'javascript:;',
            img:'2-1Z523095402E9-lp.jpg'
          },
          {
            title:'中标麒麟安全增强电子邮件系统',
            link:'javascript:;',
            img:'2-1Z409164Q03H-lp.jpg'
          },
          {
            title:'安宁安全增强电子邮件',
            link:'javascript:;',
            img:'2-1Z61014560Vb.jpeg'
          },
          {
            title:'时代亿信电子邮件',
            link:'javascript:;',
            img:'2-1Z61014560Vb.jpeg'
          },
          {
            title:'安鼎电子邮件',
            link:'javascript:;',
            img:'2-1Z61014560Vb.jpeg'
          },
        ]
      },
    ]
  }
  var application = {
    title: '桌面应用',
    name: 'application',
    list: [
      {
        title:'流式文档',
        list:[
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
        ]
      },
      {
        title:'版式文档',
        list:[
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
        ]
      },
      {
        title:'电子签章',
        list:[
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
        ]
      },
      {
        title:'输入法',
        list:[
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
        ]
      },
      {
        title:'媒体图像',
        list:[
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
          {
            title:'',
            link:'javascript:;',
            img:''
          },
        ]
      },
    ]
  }
  var open = {
    title: '开源生态',
    name: 'open',
    list: []
  }
  var publication = {
    title: '出版物',
    name: 'publication',
    list: []
  }
  var jiaoxue = {
    title: '教学平台',
    name: 'jiaoxue',
    list: []
  }
  var wangluoshebei = {
    title: '网络设备',
    name: 'wangluoshebei',
    list: []
  }
  var bankachanpin = {
    title: '板卡产品',
    name: 'bankachanpin',
    list: []
  }
  var list = [zhengji, xitong, waishe, fangan, application, open, publication, jiaoxue, wangluoshebei, bankachanpin];

  function createItem(item) {
    var $card = $(
      `<div class="col-3 p-1">
        <a href="${item.link}">
          <div class="card">
            <div class="card-top-img">
              <img src="/images/business/general2/${item.img}">
            </div>
            <div class="card-title">${item.title}</div>
          </div>
        </a>
      </div>`
    );
    return $card
  }
  function createRow(list) {
    var $row = $(`<div class="row mb-3"></div>`);
    list.forEach((elem) => {
      createItem(elem).appendTo($row);
    });
    return $row;
  }
  // 创建一组分页按钮
  function createPagination(pageData) {
    var $pagination = $(
      `<ul class="pagination">
        <li class="page-item">
          <a class="page-link" href="javascript:;">首页</a>
        </li>
        <li class="page-item disabled">
          <a class="page-link" href="javascript:;">上一页</a>
        </li>
        <li class="page-item">
          <div class="page-link">${pageData.page}/${pageData.pageCount}</div>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:;">下一页</a>
        </li>
        <li class="page-item">
          <a class="page-link" href="javascript:;">末页</a>
        </li>
      </ul>`
    );
    // console.log($pagination);
    return $pagination;
  }

  function createSec(obj) {
    var $sec = $(
      `<div class="m-3 sec">
        <div class="subtitle">${obj.title}</div>
      </div>`
    );
    // 创建分页相关数据对象
    var pageData = cPageData({ page: 1, pageSize: 8, count: obj.list.length });
    // 更新当前页面显示的数据
    var list = createList(pageData, obj.list);
    var $row = createRow(list);
    $row.appendTo($sec);

    // 创建分页按钮
    if (pageData.pageCount > 1) {
      var $pagination = createPagination(pageData);
      $pagination.appendTo($sec);
      var $btns = $pagination.children();
      // 添加事件监听器
      $btns.each((i, elem) => {
        if (i === 0) {
          elem.onclick = function () {
            page = 1;
            sel(page);
          }
        } else if (i === 1) {
          elem.onclick = function () {
            if ($($btns[1]).hasClass('disabled')) { return };
            page = pageData.page - 1;
            sel(page);
          }
        } else if (i === 3) {
          elem.onclick = function () {
            if ($($btns[3]).hasClass('disabled')) { return };
            page = pageData.page + 1;
            sel(page);
          }
        } else if (i === 4) {
          elem.onclick = function () {
            page = pageData.pageCount;
            sel(page);
          }
        }
      })

      function sel(page) {
        var oldPage = pageData.page;
        if (page === oldPage) { return };
        pageData.page = page;
        // console.log(page, oldPage);
        if (page === 1 && oldPage !== 1) {
          $($btns[1]).addClass('disabled');
        } else if (page !== 1 && oldPage === 1) {
          $($btns[1]).removeClass('disabled');
        }
        if (page === 2 && oldPage !== 2) {
          $($btns[3]).addClass('disabled');
        } else if (page !== pageData.pageCount && oldPage === pageData.pageCount) {
          $($btns[3]).removeClass('disabled');
        }
        $($btns[2].children[0]).text(`${pageData.page}/${pageData.pageCount}`);
        
        list = createList(pageData, obj.list);
        var $oldRow=$row;
        $row=createRow(list);
        $oldRow.replaceWith($row);
      }
    }

    return $sec;
  }


  // 有关页面数据操作的函数
  //更新当前显示的数据
  function createList(pageData, sourceList) {
    var start = (pageData.page - 1) * pageData.pageSize;
    var end = start + pageData.pageSize;
    if (end > pageData.count) {
      end = pageData.count;
    }
    tgtList = sourceList.slice(start, end);
    return tgtList;
  }
  // 创建分页相关数据对象
  function cPageData({ page, pageSize, count }) {
    var pageCount = Math.ceil(count / pageSize);//页码总数
    return { pageCount, pageSize, page, count };
  }

  // main 主程序
  list.forEach((elem) => {
    var $p = $(document.getElementById(elem.name));
    elem.list.forEach(elem => {
      createSec(elem).appendTo($p);
    })
  });

  var tgtOld = '#zhengji';
  var tgt = location.hash;
  if (tgt && tgtOld) {
    showTab(tgt, tgtOld);
  }
  function showTab(tgt, tgtOld) {
    $('.nav-tabs').find(`[href="${tgtOld}"]`).toggleClass('active show');
    $(document.getElementById(tgtOld.slice(1))).toggleClass('active show');
    $('.nav-tabs').find(`[href="${tgt}"]`).toggleClass('active show');
    $(document.getElementById(tgt.slice(1))).toggleClass('active show');
  }

})